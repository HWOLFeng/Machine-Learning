# Router Decision Paper

# åŸºäºP4å’Œæœºå™¨å­¦ä¹ çš„è·¯ç”±é€‰æ‹©æ–¹æ¡ˆæ¢è®¨

å‡ºå¤„ï¼šé‚®ç”µè®¾è®¡æŠ€æœ¯ 0.707

å¹´ä»½ï¼š2018 

ä½œè€…ï¼šæå€© 

å›¢é˜Ÿï¼šåŒ—é‚® 

å…³é”®è¯ï¼šå¼ºåŒ–å­¦ä¹ ã€è·¯ç”±é€‰æ‹©

æ¦‚è¿°ï¼šåŸºäºP4å’Œå¼ºåŒ–å­¦ä¹ çš„è·¯ç”±é€‰æ‹©æ–¹æ¡ˆï¼Œè·¯ç”±å†³ç­–ï¼Œæœ€å¤§é“¾è·¯åˆ©ç”¨ç‡çš„æ¯”å€¼ï¼ŒåŸºäºPPOå¼ºåŒ–å­¦ä¹ ç®—æ³•ä¸ECMPç®—æ³•æ¯”è¾ƒã€‚

ç ”ç©¶çš„é—®é¢˜ï¼šç°æœ‰æ–¹æ³•åŠä¼˜ç¼ºç‚¹ï¼šç›‘ç£å­¦ä¹ ã€éç›‘ç£å­¦ä¹ æ— æ³•åšåˆ°æœ€ä¼˜åŒ–ä¸»ä½“çš„è¡¨ç°ã€‚

è®ºæ–‡æå‡ºçš„æ€è·¯å’Œæ–¹æ³•ï¼ŒåŠä¼˜ç¼ºç‚¹

è®ºæ–‡ä½¿ç”¨çš„æ•°æ®é›†ï¼šè‡ªå·±é‡‡é›†

å·¥å…·ï¼šP4æ•°æ®å±‚é‡‡é›†å·¥å…·ï¼›å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼šPPO

è®ºæ–‡ä½¿ç”¨çš„å®éªŒæ–¹æ³•ï¼š

![](./Router Decision/P4.png)

# Learning To Route

å‡ºå¤„ï¼šProceeding HotNets-XVI Proceedings of the 16th ACM Workshop on Hot Topics in Networks Pages 185-191

å¹´ä»½ï¼š2017

ä½œè€…ï¼šAsaf Valadarsky

å›¢é˜Ÿï¼šHebrew University of Jerusalem

å…³é”®è¯ï¼š

Reinforcement Learning, Intradomain Route Configuration, Demand Matrix, Routing Strategy, Softmin

æ¦‚è¿°ï¼š

åŸŸå†…æµé‡å·¥ç¨‹çš„ç»å…¸è®¾ç½®ã€‚ æœ‰å…³æ•°æ®é©±åŠ¨è·¯ç”±ï¼Œåº”ç”¨MLï¼ˆç‰¹åˆ«æ˜¯æ·±åº¦å¼ºåŒ–å­¦ä¹ ï¼‰å¯äº§ç”Ÿé«˜æ€§èƒ½ï¼Œå¹¶ä¸”æ˜¯è¿›ä¸€æ­¥ç ”ç©¶çš„æœ‰å¸Œæœ›çš„æ–¹å‘ã€‚ 

ç ”ç©¶çš„é—®é¢˜ï¼š

ML-guided routing the optimization of routing within a single, self-administered network.

(1) How should routing be formulated as an ML problem? 

(2) What are suitable representations for the inputs and outputs of learning in this domain? 

ç°æœ‰æ–¹æ³•åŠä¼˜ç¼ºç‚¹ï¼š

- supervised learning ï¼Œsupervised learning might be ineffective if the traffic conditions do not exhibit very high regularity

è®ºæ–‡æå‡ºçš„æ€è·¯å’Œæ–¹æ³•ï¼š

- a model for data-driven (intradomain) routing that builds on the rich body of literature on intradomain TE and (multicommodity) flow optimization. 
- For Question (2)ï¼Œdevise methods for constraining the size of the output without losing â€œtoo muchâ€ in terms of routing expressivenessï¼Œleverage ideas from the literature on **hop-by-hop**

è®ºæ–‡ä½¿ç”¨çš„æ•°æ®é›†ï¼š

å·¥å…·ï¼šP4æ•°æ®å±‚é‡‡é›†å·¥å…·ï¼›å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼šPPO

è®ºæ–‡ä½¿ç”¨çš„å®éªŒæ–¹æ³•ï¼š

- åè¯

ï¼ˆ1ï¼‰**Network**ï¼ša capacitated directed graph $G=(V, E, c)$ï¼Œwhere V and E are the vertex and edge sets, respectively, and $c: E \rightarrow \mathbb{R}^{+}$ assigns a capacity to each edge. 

ï¼ˆ2ï¼‰**Routing**ï¼š$\Gamma(v)$denote vertex vâ€™s neighboring vertices in G.$\mathcal{R}_{v,(s, t)}: \Gamma(v) \rightarrow[0,1]$ï¼Œsuch that $\mathcal{R}_{v,(s, t)}(u)$ is the **fraction** of traffic from $s$ to $t$ **traversing** v that v forwards to its neighbor u. $\sum_{u \in \Gamma(v)} \mathcal{R}_{v,(s, t)}(u)=1$ï¼ˆno traffic is blackholed at a non-destinationï¼‰ï¼Œandï¼Œ$\sum_{u \in \Gamma(v)} \mathcal{R}_{t,(s, t)}(u)=0$ï¼ˆall traffic to a destination is absorbed at that destination ï¼‰

ï¼ˆ3ï¼‰**Induced flows of traffic**ï¼š***demand matrix*** (DM) ï¼ˆthe realistic scenario in which the DM is not known beforehand.ï¼‰D is a $nÃ—n$ ï¼Œ$D_{i, j}$specifies the **traffic demand** between source i and destination jã€‚ï¼ˆå¥½åƒæ˜¯æ¯ä¸ªvertexçš„æµé‡ï¼Œå¯ä»¥å±‚å±‚é€’æ¨ï¼‰

ï¼ˆ4ï¼‰**evaluate traffic flow**ï¼š**minimizing link (over) utilization** ã€‚The link utilization under a specific multicommodity flow $f$ is $\max _{e \in E} \frac{f_{e}}{c(e)}$ï¼Œ $f_e$ is the total amount of flow traversing edge $e$ under flow $f$ ã€‚

ï¼ˆ5ï¼‰**Routing future traffic demands **ï¼šthe routing strategy $\mathcal{R}^{(t)}$ for that epoch is decided ï¼Œcan depend only on the history of ***past*** traffic patterns and routing strategies (from epochs 1, . . . , t âˆ’ 1). 

- Supervised Learning Approach 

the learning algorithm observes the **history** of DMs up to the current epoch, and predicts the DM for the **upcoming** epoch. This prediction is then used to **generate an optimal routing strategy** with respect to the predicted DM. 

the (deterministic) **gravity model** and the (probabilistic) **bimodal model**. ï¼ˆç¡®å®šæ¨¡å‹ï¼šé€šä¿¡è¾“å‡ºä¸å¸¦å®½æˆæ¯”ä¾‹çš„åœºæ™¯ï¼Œæ¦‚ç‡æ¨¡å‹ï¼šç«¯ç‚¹åˆ†ä¸ºå°æµé‡å’Œå¤§æµé‡åœºæ™¯ï¼‰

 also consider â€œ***sparsifications***â€ of gravity/bimodal DMs generated by selecting, uniformly at random, a **p-fraction** of the communicating pairs, for some choice of p âˆˆ [0, 1], and **removing** the traffic demandsï¼ˆDMsï¼‰ of all other pairs from consideration. 

**Class I**: DM sequences in which the next DM is *deterministically* derived from past DMs. 

**Class II**: DM sequences in which each DM is **independent** of the previous DMs.

- Reinforcement Learning Approach 

æœªæ¥å¯èƒ½çš„åº”ç”¨æ–¹å‘ï¼š

(1) extending our approach to other routing contexts

(2) examining other performance metrics

(3) identifying better supervised learning approaches to traffic-demand estimation

(4) scaling reinforcement learning in this context, and beyond.

# A Survey on Deep Learning for the Routing Layer of Computer Network 

å‡ºå¤„ï¼šUK/ China Emerging Technologies (UCET)

å¹´ä»½ï¼š2019

ä½œè€…ï¼šFengling Jiang 

å›¢é˜Ÿï¼šåˆè‚¥å¸ˆèŒƒå¤§å­¦ï¼Œ*Edinburgh Napier University* 

å…³é”®è¯ï¼šDeep learning, Computer network, Routing layer, Reinforcement learning 

æ¦‚è¿°ï¼šæ¦‚è¿°äº†è®¡ç®—æœºç½‘ç»œä¸­è·¯ç”±å±‚çš„æ·±åº¦å­¦ä¹ æ–¹æ³•ã€‚

ç ”ç©¶çš„é—®é¢˜ï¼šç°æœ‰æ–¹æ³•åŠä¼˜ç¼ºç‚¹ï¼šç›‘ç£å­¦ä¹ ã€éç›‘ç£å­¦ä¹ æ— æ³•åšåˆ°æœ€ä¼˜åŒ–ä¸»ä½“çš„è¡¨ç°ã€‚

è®ºæ–‡æå‡ºçš„æ€è·¯å’Œæ–¹æ³•ï¼ŒåŠä¼˜ç¼ºç‚¹

è®ºæ–‡ä½¿ç”¨çš„æ•°æ®é›†ï¼šè‡ªå·±é‡‡é›†

å·¥å…·ï¼šP4æ•°æ®å±‚é‡‡é›†å·¥å…·ï¼›å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼šPPO

è®ºæ–‡ä½¿ç”¨çš„å®éªŒæ–¹æ³•ï¼š



# Losing control of the internet-using the data plane to attack the control plane

å…³é”®è¯ï¼šDDoSï¼ŒBGPï¼Œbotnetï¼ŒInternetï¼ŒCXPSTï¼ŒZMW

æ€»ç»“ï¼š

æå‡ºäº†CXPSTï¼ˆCoordinated Cross Plane Session Terminationï¼‰æ–¹æ³•ï¼Œåˆ©ç”¨åƒµå°¸ğŸ§Ÿâ€â™‚ï¸ç½‘ç»œå½±å“core ASï¼Œç›®çš„æ˜¯ä½¿core ASä¸æ–­æ›´æ–° BGP routeï¼Œå¯¼è‡´control planeçš„ä¸ç¨³å®šã€‚

1. å¤§é‡å‘é€è¯·æ±‚ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´core ASæ•°æ®å¹³é¢æ‹¥å¡ï¼Œè¿›ä¸€æ­¥ä½¿å¾—BGP sessionå¤±è´¥ï¼Œcore AS ç¦»çº¿ã€‚
2. core ASæ¢å¤å‰ï¼Œç›¸é‚»fringe ASes Upateè·¯ç”±ï¼Œå‘å¾€core ASçš„æµé‡å°†droppedï¼Œéšåæµé‡å¯¼å‘åˆ«çš„ASè·¯ç”±ï¼ŒBotnet Attackeråœæ­¢æ”»å‡»ã€‚
3. core ASæ¢å¤åï¼Œå‘é€OPENè¯·æ±‚æ›´æ–°è·¯ç”±è¡¨ribï¼Œç›¸é‚»fringe ASes å“åº”è¯·æ±‚ï¼Œä¼ é€’è·¯ç”±è¡¨ã€‚Botnet Attackerå†æ¬¡è¿›è¡Œæ”»å‡»ï¼Œå¦‚æ­¤å¾€å¤ã€‚

åå¤çš„Updateå¼•å‘è·¯ç”±flappingï¼Œå½±å“é€æ¸æ‰©æ•£ï¼Œç³»ç»Ÿè´Ÿè½½å¢åŠ ï¼Œcrippingæ•´ä¸ªInternet control planeã€‚

## Introduction

æ•°æ®å¹³é¢ï¼ˆdata planeï¼‰ã€æ§åˆ¶å¹³é¢ï¼ˆcontrol planeï¼‰

ï¼ˆæœ‰ç»“è®ºäºŒè€…æ˜¯ä¼šç›¸äº’å½±å“çš„ï¼‰

åœ¨è·¯ç”±é—®é¢˜ä¸­ï¼Œæ§åˆ¶å¹³é¢æ˜¯ä¸ºäº†è§£å†³é“¾æ¥æ•…éšœï¼Œä»è€Œæé«˜æœ¬åœ°ç¨³å®šæ€§ã€‚ä½†æ˜¯ä¸ºäº†ç¨³å®šæœ¬åœ°ç³»ç»Ÿï¼Œå°†ä¼šå¯¹å…¨å±€äº§ç”Ÿå½±å“ï¼Œè¿™å°†ä¼šå¯¼è‡´æ•´ä¸ªInternetçš„ä¸ç¨³å®šã€‚router mis-configurationï¼Œhardware failureï¼Œas side-effectsï¼ˆå‰¯ä½œç”¨ï¼‰ of a fast-propagating worméƒ½å¯èƒ½å¼•èµ·è¿™ä¸€é—®é¢˜ã€‚

## Background

### 1

core ASesï¼šå…·æœ‰high degree of connectivity ï¼ˆè¿ç»“ä¸­å¿ƒï¼‰

fringe ASes: ä¸æ€ä¹ˆé‡è¦çš„ASï¼Œå¾€å¾€éœ€è¦å€ŸåŠ©core AS ä¼ æ’­æµé‡ã€‚

### 2

å½“ç½‘ç»œç¯å¢ƒå˜åŒ–æ—¶ï¼Œrouteçš„å˜åŒ–ï¼šwithdrawing routes, determine new routes, and advertising changes

æ­£å¸¸è¿è¡Œçš„è·¯ç”±å™¨å°†ç»§ç»­å‘ä¸å­˜åœ¨çš„è·¯ç”±å™¨è½¬å‘æµé‡ï¼Œç›´åˆ°å®Œæˆå¯»æ‰¾æ–°è·¯ç”±çš„è¿‡ç¨‹ä¸ºæ­¢ã€‚æŒ‡å‘æ•…éšœè·¯ç”±å™¨çš„æ‰€æœ‰æµé‡éƒ½å°†è¢«ä¸¢å¼ƒã€‚ åªæœ‰åœ¨å—å½±å“çš„è·¯ç”±å™¨å®ŒæˆBGPæ¶ˆæ¯çš„å¤„ç†åï¼Œæ‰èƒ½æ¢å¤æ•°æ®å¹³é¢åŠŸèƒ½ã€‚ åœ¨å‘ç”Ÿå¤§é‡ä¸ç¨³å®šæƒ…å†µçš„æƒ…å†µä¸‹ï¼Œè·¯ç”±å™¨CPUçš„è´Ÿè½½ä¼šæ€¥å‰§å¢åŠ ï¼Œå¯èƒ½ä¼šè¶…è¿‡å·²ç»è´Ÿæ‹…çš„è·¯ç”±å¤„ç†å™¨çš„å®¹é‡ã€‚

### 3

ZMWï¼Œåˆ©ç”¨å—å®³ç«¯data planeçš„æ‹¥å¡ï¼Œæ¬ºéª—ä¸€å¯¹routeræ–­å¼€ä¹‹é—´çš„è¿ç»“ã€‚å¯¼è‡´BGPå¤±è´¥ï¼Œå¤±è´¥ä¼šå¼•èµ·routeçš„é‡æ–°è®¡ç®—ã€‚

## CXPST

1. **Selecting Targets**:  $C_{B}(e)=\sum_{s \neq t \in V}path_{st}(e)$ï¼Œè¡¨ç¤ºï¼šsä¸tä¹‹é—´ä¸eæœ‰å…³çš„è·¯å¾„ã€‚Attackerå¯ä»¥ç”Ÿæˆé“¾è·¯çš„BGPä¹‹é—´çš„ç²—ç•¥åº¦é‡ã€‚æ¯å½“æ±‡æ€»çš„tracerouteæ•°æ®æ–°åŠ å…¥ä¸€æ¡è¾¹æ—¶ï¼Œå®ƒå°±ä¼šä»£è¡¨ä¸€æ¡è·¨è¶Šç»™å®šé“¾æ¥çš„å•ç‹¬è·¯çº¿ã€‚
2. **Dealing With Changing Topology:** ä¸ä»…è¦æ£€æŸ¥ç»™å®šè·¯å¾„æ˜¯å¦åŒ…å«ç›®æ ‡é“¾æ¥ï¼Œè¿˜å¿…é¡»ç¡®ä¿è¯¥è·¯å¾„ä¹Ÿä¸åŒ…å«å…¶ä»–ç›®æ ‡é“¾æ¥ã€‚è¿™æ ·ï¼Œå½“å®šä½çš„é“¾æ¥å¤±è´¥æ—¶ï¼Œæ”»å‡»æµé‡å°†ä¸ä¼šé‡æ–°è·¯ç”±ã€‚
3. **Fixing the Flow Issue:** ä¸ºäº†åœ¨åˆ°è¾¾ç›®æ ‡é“¾æ¥ä¹‹å‰æœ€å¤§ç¨‹åº¦åœ°å‡å°‘æ‹¥å¡ï¼Œæ”»å‡»è€…åº”ä¿æŒæ”»å‡»æµé‡**æ•£å¸ƒ**ï¼Œç›´åˆ°åˆ°è¾¾ç›®æ ‡ä¸ºæ­¢ã€‚å½“æ”»å‡»æµé‡åˆ°è¾¾ç›®æ ‡é“¾æ¥æ—¶ï¼Œæ”»å‡»æµå°†**èšåˆ**åœ¨ä¸€èµ·ï¼Œä»è€Œå¯¼è‡´è¯¥é“¾æ¥ä¸Šçš„æ‹¥å¡ã€‚**Attacker -> Link -> Destination Net**ã€‚ï¼ˆ1ï¼‰MaxFlowç®—æ³•ï¼Œç¡®å®šä½¿ç”¨çš„Botnetï¼ˆ2ï¼‰æµé‡åˆ†æï¼Œç¡®å®šæµé‡ç›®çš„åœ°ã€‚
4. **Thwarting Defenses:** Botnetè®¾ç½®æ—¶é—´çª—å£ï¼Œå½“ç›®æ ‡Linkåœ¨æ—¶é—´å†…æœªé‡æ–°å‡ºç°ï¼Œé‚£ä¹ˆå°†é‡æ–°é€‰æ‹©Linkï¼Œå†æ¬¡æ”»å‡»ç›®æ ‡Netã€‚

## SIMULATION

1,829 ASes and 13,000 edges 

AS links we use **OC-768** size links, the largest link size currently in the SONET standard, for those links. In the same spirit we connect all fringe ASes, where the majority of the attackerâ€™s resources reside, with **OC-3** links. 

IP addresses of infected machines were mapped to their parent ASes using the **GeoIP** database 

To ensure a proper lower bound for attacker bandwidth, bots were given a basic **ADSL** connections with an upload capacity capped at 1.0 Mbit/sec. 

**CDF**ï¼ˆCumulative Distribution Functionï¼‰ï¼šç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼Œè¯„ä¼°ASæ”»å‡»å‰åçš„è´Ÿè½½å˜åŒ–æƒ…å†µ